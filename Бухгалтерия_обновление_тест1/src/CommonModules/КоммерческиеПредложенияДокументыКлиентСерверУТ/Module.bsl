////////////////////////////////////////////////////////////////////////////////
// ОбщийМодуль.КоммерческиеПредложенияДокументыКлиентСерверУТ.
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// См. КоммерческиеПредложенияДокументыКлиентСерверПереопределяемый.СформироватьПредставлениеСостоянияПоСтатусу
//
// Параметры:
//  Форма        - ФормаКлиентскогоПриложения.
//  Статус       - ОпределяемыйТип.СтатусыКоммерческихПредложенийКлиентам.
//  ТекущаяДата  - Дата.
//
Процедура СформироватьПредставлениеСостоянияПоСтатусу(Форма, Статус, ТекущаяДата) Экспорт
	
	Состояние = "";
	СрокДействия = Форма.Объект.СрокДействия;
	
	Если Статус = ПредопределенноеЗначение("Перечисление.СтатусыКоммерческихПредложенийКлиентам.НеСогласовано") Тогда
		Состояние = НСтр("ru='На согласовании.';uk='На погодженні.'");
	ИначеЕсли Статус = ПредопределенноеЗначение("Перечисление.СтатусыКоммерческихПредложенийКлиентам.Черновик") Тогда
		Состояние = НСтр("ru='Подготавливается.';uk='Підготовлюється.'");
	ИначеЕсли Статус = ПредопределенноеЗначение("Перечисление.СтатусыКоммерческихПредложенийКлиентам.Отменено") Тогда
		Состояние = НСтр("ru='Отменено.';uk='Скасовано.'");
	ИначеЕсли Статус = ПредопределенноеЗначение("Перечисление.СтатусыКоммерческихПредложенийКлиентам.Действует") Тогда
		
		Если СрокДействия >= ТекущаяДата Тогда
			Состояние = НСтр("ru='Действует.';uk='Діє.'");
		Иначе
			Состояние = НСтр("ru='Срок действия окончен.';uk='Термін дії закінчився.'");
		КонецЕсли;
		
	КонецЕсли;
	
	ЭлементФормыСостояние = Форма.Элементы.Состояние; // ДекорацияФормы 
	ЭлементФормыСостояние.Заголовок = Состояние;
	
КонецПроцедуры

// См. КоммерческиеПредложенияДокументыКлиентСерверПереопределяемый.СформироватьПредставлениеНоменклатурыДляПечати
//
Процедура СформироватьПредставлениеНоменклатурыДляПечати(ПредставлениеДляПечати, Номенклатура, Характеристика, СтандартнаяОбработка) Экспорт
	
	СтандартнаяОбработка = Ложь;
	ПредставлениеДляПечати = КоммерческиеПредложенияДокументыУТВызовСервера.ПредставлениеНоменклатурыДляПечати(Номенклатура, Характеристика);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция НалогообложениеНДСПоНалогообложениюКоммерческихПредложений(Налогообложение) Экспорт

	Если Налогообложение = Неопределено Тогда
//	Если Налогообложение Тогда
		Возврат ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС");
	Иначе
//		Возврат ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС");
		Возврат Налогообложение;
	КонецЕсли;                         	

КонецФункции

Функция НалогообложениеКоммерческихПредложенийПоНалогообложениюНДС(НалогообложениеНДС) Экспорт
	Если НалогообложениеНДС = ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС") Тогда
		Возврат ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС");
	ИначеЕсли НалогообложениеНДС = ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС") Тогда
		Возврат ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС");
	ИначеЕсли НалогообложениеНДС = ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаОсвобожденаОтНДС") Тогда
		Возврат ПредопределенноеЗначение("Перечисление.ТипыНалогообложенияНДС.ПродажаОсвобожденаОтНДС");
	КонецЕсли;
КонецФункции

Функция ХозяйственнаяОперацияДокументаКоммерческоеПредложениеКлиенту(Операция) Экспорт
	
	Если Операция = ПредопределенноеЗначение("Перечисление.ВидыОперацийКоммерческихПредложений.ЗакупкаУПоставщика") Тогда
		
		ХозяйственнаяОперация = ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.РеализацияКлиенту");
		
	Иначе
		
		ХозяйственнаяОперация = ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.ПередачаНаКомиссию");
		
	КонецЕсли;
	
	Возврат ХозяйственнаяОперация;
	
КонецФункции

Функция МассивОтборовПоТипуНоменклатуры(ВидОперации) Экспорт
	
	Если ВидОперации = ПредопределенноеЗначение("Перечисление.ВидыОперацийКоммерческихПредложений.ЗакупкаУПоставщика") Тогда
		МассивОтборов = НоменклатураКлиентСервер.ОтборПоТоваруМногооборотнойТареУслугеРаботе(Истина);
	Иначе
		МассивОтборов = НоменклатураКлиентСервер.ОтборПоТоваруМногооборотнойТареРаботе(Истина);
	КонецЕсли;
	
	РезультатПоиска = МассивОтборов.Найти(ПредопределенноеЗначение("Перечисление.ТипыНоменклатуры.МногооборотнаяТара"));
	
	Если РезультатПоиска <> Неопределено Тогда
		МассивОтборов.Удалить(РезультатПоиска);
	КонецЕсли;
	
	Возврат МассивОтборов;
	
КонецФункции

#КонецОбласти
